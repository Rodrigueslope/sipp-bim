!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SIPP BIM — Simulador (One-Page)</title>
  <style>
    :root{
      --bg:#f6f8fb; --card:#fff; --ink:#1f2937; --muted:#6b7280;
      --brand:#2563eb; --line:#e5e7eb; --ok:#16a34a; --warn:#f59e0b;
      --radius:14px; --shadow:0 6px 24px rgba(0,0,0,.06);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:15px/1.5 system-ui,Segoe UI,Roboto,Arial}
    .wrap{max-width:1200px;margin:32px auto;padding:0 16px}
    header{margin-bottom:16px}
    h1{margin:0 0 6px;font-size:22px}
    .sub{color:var(--muted);font-size:13px}
    .grid{
      display:grid; gap:16px;
      grid-template-columns: 1.3fr .7fr;
    }
    @media (max-width:980px){ .grid{grid-template-columns: 1fr} }

    .card{
      background:var(--card); border:1px solid var(--line); border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .card .hd{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px; border-bottom:1px solid var(--line);
    }
    .card .hd h2{margin:0;font-size:16px}
    .card .hd .toggle{
      border:0;background:transparent;color:var(--brand);cursor:pointer;font-weight:600;
    }
    .card .bd{padding:16px; display:block}
    .card.collapsed .bd{display:none}

    .form-grid{display:grid; gap:12px; grid-template-columns: repeat(2, minmax(0,1fr));}
    @media (max-width:680px){ .form-grid{grid-template-columns: 1fr} }
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    input[type="text"], input[type="number"], select, textarea{
      width:100%; padding:10px 12px; border:1px solid var(--line); border-radius:10px; background:#fff;
      font:inherit;
    }
    .hint{font-size:12px;color:var(--muted)}
    .note{display:flex;gap:8px;align-items:flex-start;background:#eef2ff;border:1px solid #dbeafe;padding:10px 12px;border-radius:10px;font-size:13px}

    /* Lateral fixa */
    aside{position:sticky; top:16px; height:fit-content; display:flex; flex-direction:column; gap:16px}
    .summary li{display:flex;justify-content:space-between;gap:12px;padding:6px 0;border-bottom:1px dashed var(--line)}
    .summary li:last-child{border-bottom:0}
    .btn{
      appearance:none; border:0; border-radius:12px; padding:12px 16px;
      font-weight:700; cursor:pointer;
    }
    .btn.primary{background:var(--brand); color:#fff}
    .btn.ghost{background:#fff;border:1px solid var(--line);color:var(--ink)}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .pill{display:inline-block;padding:6px 10px;border:1px solid var(--line);border-radius:999px;font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Simulador de Preços de Projetos e Serviços BIM — SIPP BIM</h1>
      <div class="sub">Tudo em uma página. Preencha os blocos à esquerda, revise à direita e clique em “Simular Custo”.</div>
    </header>

    <div class="grid">
      <!-- COLUNA ESQUERDA (conteúdo) -->
      <main class="stack" style="display:flex;flex-direction:column;gap:16px">

        <!-- 1. Dados do Projeto/Serviço -->
        <section class="card" data-section="dados">
          <div class="hd">
            <h2>1. Dados do Projeto ou Serviço</h2>
            <button class="toggle" data-toggle>Recolher</button>
          </div>
          <div class="bd">
            <div class="form-grid">
              <div>
                <label for="tipo">Tipo do Projeto/Serviço</label>
                <select id="tipo">
                  <option>Arquitetônico</option><option>Estrutural</option><option>Instalações</option><option>Consultoria</option>
                </select>
              </div>
              <div>
                <label for="area">Área do Projeto (m²)</label>
                <input id="area" type="number" min="0" step="1" placeholder="ex: 1000"/>
              </div>
              <div>
                <label for="local">Localidade (UF/Município) <span class="hint">apenas para referência contextual</span></label>
                <input id="local" type="text" placeholder="ex: SP, RJ, AM"/>
              </div>
              <div>
                <label for="complex">Complexidade do Projeto</label>
                <select id="complex">
                  <option value="baixa">Baixa</option>
                  <option value="media" selected>Média</option>
                  <option value="alta">Alta</option>
                </select>
              </div>
              <div>
                <label for="lod">Nível de Desenvolvimento BIM (LOD)</label>
                <select id="lod">
                  <option>LOD 200</option><option selected>LOD 300</option><option>LOD 350</option><option>LOD 400</option>
                </select>
              </div>
            </div>
          </div>
        </section>

        <!-- 2. Tipo de Cálculo -->
        <section class="card" data-section="tipo">
          <div class="hd">
            <h2>2. Defina Tipo de Cálculo</h2>
            <button class="toggle" data-toggle>Recolher</button>
          </div>
          <div class="bd">
            <div class="note">
              <span>ℹ️</span>
              <div><strong>Atenção:</strong> escolha no item 4 a base Sinduscon/Região para usar o cálculo por m².</div>
            </div>
            <div style="margin-top:12px;display:grid;gap:10px">
              <label><input type="radio" name="calc" value="m2" checked> Valor por metro quadrado (R$/m²)</label>
              <label><input type="radio" name="calc" value="hora"> Valor por hora técnica (R$/h) — Estimativa</label>
              <label><input type="radio" name="calc" value="phoras"> Por Hora Técnica dos Profissionais Envolvidos</label>
              <label><input type="radio" name="calc" value="escopo"> Valor fechado por escopo — Estimativa</label>
            </div>
          </div>
        </section>

        <!-- 3. Perfil dos Profissionais -->
        <section class="card" data-section="perfil">
          <div class="hd">
            <h2>3. Defina o Perfil dos Profissionais</h2>
            <button class="toggle" data-toggle>Recolher</button>
          </div>
          <div class="bd">
            <div class="hint" style="margin-bottom:10px">Valores médios Brasil. Informe quantos profissionais atuarão.</div>
            <div class="form-grid">
              <div>
                <label>Engenheiro Júnior (R$ 85/h)</label>
                <input id="qtd_eng_jr" type="number" min="0" step="1" value="0">
              </div>
              <div>
                <label>Engenheiro Pleno (R$ 145/h)</label>
                <input id="qtd_eng_pl" type="number" min="0" step="1" value="0">
              </div>
              <div>
                <label>Engenheiro Sênior (R$ 210/h)</label>
                <input id="qtd_eng_sr" type="number" min="0" step="1" value="0">
              </div>
              <div>
                <label>Arquiteto (R$ 75/h)</label>
                <input id="qtd_arq" type="number" min="0" step="1" value="0">
              </div>
            </div>
          </div>
        </section>

        <!-- 4. Base de Cálculo -->
        <section class="card" data-section="base">
          <div class="hd">
            <h2>4. Base de Cálculo Referencial</h2>
            <button class="toggle" data-toggle>Recolher</button>
          </div>
          <div class="bd">
            <div class="actions" style="margin-bottom:10px">
              <span class="pill">Sinduscon-PA (Norte)</span>
              <span class="pill">Sinduscon-PI (Nordeste)</span>
              <span class="pill">Sinduscon-SP (Sudeste)</span>
              <span class="pill">Sinduscon-PR (Sul)</span>
              <span class="pill">Sinduscon-GO (Centro-Oeste)</span>
            </div>
            <div class="hint">Nota: Para m², selecione uma base Sinduscon.</div>
          </div>
        </section>
      </main>

      <!-- COLUNA DIREITA (painel lateral) -->
      <aside>
        <section class="card">
          <div class="hd"><h2>Resumo</h2></div>
          <div class="bd">
            <ul class="summary" id="resumo">
              <li><span>Tipo</span><strong id="r_tipo">—</strong></li>
              <li><span>Área</span><strong id="r_area">—</strong></li>
              <li><span>Complexidade</span><strong id="r_complex">—</strong></li>
              <li><span>LOD</span><strong id="r_lod">—</strong></li>
              <li><span>Modelo</span><strong id="r_calc">m²</strong></li>
            </ul>
          </div>
        </section>

        <section class="card">
          <div class="hd"><h2>Resultado</h2></div>
          <div class="bd">
            <div style="font-size:28px;font-weight:800" id="resultado">R$ —</div>
            <div class="hint" id="observacoes">Observações do cálculo aparecerão aqui.</div>
            <div style="height:8px"></div>
            <button class="btn primary" id="btnSimular">Simular Custo</button>
            <div style="height:8px"></div>
            <button class="btn ghost" id="btnExportar">Exportar PDF/Planilha</button>
          </div>
        </section>
      </aside>
    </div>
  </div>

  <script>
    // Util: salva/recupera estado
    const KEY="sippbim:v1";
    const $ = (sel,ctx=document)=>ctx.querySelector(sel);
    const $$ = (sel,ctx=document)=>Array.from(ctx.querySelectorAll(sel));

    // Colapsar/expandir
    $$('[data-toggle]').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const card = btn.closest('.card');
        card.classList.toggle('collapsed');
        btn.textContent = card.classList.contains('collapsed') ? 'Expandir' : 'Recolher';
      });
    });

    // Auto-resumo
    const map = {
      tipo: $('#tipo'),
      area: $('#area'),
      complex: $('#complex'),
      lod: $('#lod'),
      calc: ()=>document.querySelector('input[name="calc"]:checked')?.value || 'm2',
      r_tipo: $('#r_tipo'), r_area: $('#r_area'), r_complex: $('#r_complex'), r_lod: $('#r_lod'), r_calc: $('#r_calc'),
    };

    function updateResumo(){
      map.r_tipo.textContent = map.tipo.value;
      map.r_area.textContent = map.area.value ? `${map.area.value} m²` : '—';
      map.r_complex.textContent = map.complex.options[map.complex.selectedIndex].text;
      map.r_lod.textContent = map.lod.value;
      map.r_calc.textContent = map.calc().toUpperCase();
    }

    // Persistência
    function save(){
      const state = {
        tipo: map.tipo.value, area: map.area.value, complex: map.complex.value, lod: map.lod.value,
        calc: map.calc(),
        qtds: {
          eng_jr: $('#qtd_eng_jr').value,
          eng_pl: $('#qtd_eng_pl').value,
          eng_sr: $('#qtd_eng_sr').value,
          arq: $('#qtd_arq').value
        }
      };
      localStorage.setItem(KEY, JSON.stringify(state));
    }
    function load(){
      const raw = localStorage.getItem(KEY); if(!raw) return;
      const s = JSON.parse(raw);
      map.tipo.value = s.tipo ?? map.tipo.value;
      map.area.value = s.area ?? '';
      map.complex.value = s.complex ?? map.complex.value;
      map.lod.value = s.lod ?? map.lod.value;
      if(s.calc){ const el = document.querySelector(`input[name="calc"][value="${s.calc}"]`); if(el) el.checked = true; }
      $('#qtd_eng_jr').value = s.qtds?.eng_jr ?? 0;
      $('#qtd_eng_pl').value = s.qtds?.eng_pl ?? 0;
      $('#qtd_eng_sr').value = s.qtds?.eng_sr ?? 0;
      $('#qtd_arq').value    = s.qtds?.arq ?? 0;
      updateResumo();
    }

    // Disparadores
    ['change','input'].forEach(evt=>{
      document.addEventListener(evt, e=>{
        if(e.target.closest('input,select,textarea')){ updateResumo(); save(); }
      });
    });

    // Hook de cálculo — plugue sua lógica aqui
    function recalculate(){
      const modelo = map.calc(); // 'm2' | 'hora' | 'phoras' | 'escopo'
      const area = parseFloat(map.area.value||0);
      // EXEMPLO didático (troque pelas suas funções reais)
      let valor = 0, obs = '';
      if(modelo==='m2'){
        const baseM2 = 65; // <- traga do Sinduscon selecionado
        valor = area * baseM2;
        obs = `Base: R$ ${baseM2.toFixed(2)}/m² (Sinduscon selecionado) × Área informada.`;
      }else if(modelo==='hora'){
        const tarifaHora = 160; // média estimativa
        const horas = 120;      // placeholder
        valor = tarifaHora * horas;
        obs = `Estimativa por hora técnica: ${horas}h × R$ ${tarifaHora.toFixed(2)}/h.`;
      }else if(modelo==='phoras'){
        const hrs = { jr: 60, pl: 80, sr: 40, arq: 60 }; // placeholders
        const tarifas = { jr:85, pl:145, sr:210, arq:75 };
        const qtds = {
          jr: +$('#qtd_eng_jr').value, pl: +$('#qtd_eng_pl').value,
          sr: +$('#qtd_eng_sr').value, arq: +$('#qtd_arq').value
        };
        valor = (qtds.jr*hrs.jr*tarifas.jr) + (qtds.pl*hrs.pl*tarifas.pl) + (qtds.sr*hrs.sr*tarifas.sr) + (qtds.arq*hrs.arq*tarifas.arq);
        obs = `Somatório de horas por perfil × tarifa (valores médios). Ajuste hrs/tarifas conforme projeto.`;
      }else if(modelo==='escopo'){
        valor = 35000; // placeholder
        obs = `Preço fechado estimativo conforme escopo e complexidade.`;
      }
      // Ajustes por complexidade (exemplo simples)
      const mult = { baixa:0.9, media:1.0, alta:1.25 }[map.complex.value] || 1;
      valor *= mult; if(mult!==1) obs += ` Fator de complexidade aplicado (${map.complex.value}).`;

      $('#resultado').textContent = isFinite(valor) && valor>0 ? `R$ ${valor.toLocaleString('pt-BR',{minimumFractionDigits:2})}` : 'R$ —';
      $('#observacoes').textContent = obs;
    }

    // Botões
    $('#btnSimular').addEventListener('click', recalculate);
    $('#btnExportar').addEventListener('click', ()=>{
      alert('Aqui você pode chamar sua exportação para PDF/Planilha.');
    });

    // Init
    load(); updateResumo();
  </script>
</body>
</html>


