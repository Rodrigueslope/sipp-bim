<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Precificação  de Projetos e Serviços  BIM - SIPP BIM</title>
      <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="style.css"> 
</head>
<body>
    <div class="logo-container">
        <img src="sipp.png" alt="Logo RBIM">
    </div>
    
    <h1>Simulador de Preços  de Projetos e Serviços  BIM - SIPP BIM</h1>
    
    <div class="container">
        <section id="tipo-projeto-section">
            <h2><span class="titulo-com-fundo">1. Defina o  Projeto ou Serviço (BIM)</span></h2>
            <select id="tipo-projeto">
                <option value="Arquitetônico">Arquitetônico</option>
                <option value="Estrutural">Estrutural</option>
                <option value="Instalação Elétrica">Instalação Elétrica</option>
                <option value="Instalação Hidráulica">Instalação Hidráulica</option>
                <option value="Combate a Incêndio">Combate a Incêndio</option>
                <option value="Compatibilização BIM">Compatibilização BIM</option>
                <option value="Coordenação BIM">Coordenação BIM</option>
                <option value="As Built / Levantamento BIM">As Built / Levantamento BIM</option>
                <option value="Digital Twin">Digital Twin</option>
                <option value="Outros (especificar)">Outros (especificar)</option>
            </select>
            
            <p>Obs: Múltiplas disciplinas podem ser consideradas na complexidade ou escopo detalhado.</p>
        </section>
        
        <section id="tipo-calculo-section">
  <h2><span class="titulo-com-fundo">2. Defina Tipo de Cálculo</span></h2>

  <div>
    <label>
      <input type="radio" id="calc-metro" name="tipo-calculo" value="metro" checked>
      Valor por metro quadrado (R$/m²)
    </label>
  </div>

  <div>
    <label>
      <input type="radio" id="calc-hora" name="tipo-calculo" value="hora">
      Valor por hora técnica (R$/h) - Estimativa
    </label>
  </div>

  <div>
    <label>
      <input type="radio" id="calc-hora-perfil" name="tipo-calculo" value="hora-perfil">
      Por Hora Técnica dos Profissionais Envolvidos
    </label>
  </div>

  <div>
    <label>
      <input type="radio" id="calc-escopo" name="tipo-calculo" value="escopo">
      Valor fechado por escopo - Estimativa
    </label>
  </div>
</section>
        
        <section id="dados-simulacao-section">
            <h2><span class="titulo-com-fundo">3. Dados Para Simulação</span></h2>
            
            <label for="area">Área do Projeto (m²):</label>
            <input type="number" id="area" min="1" value="1000">
            
            <label for="localidade">Localidade (Estado - apenas para referência contextual):</label>
            <input type="text" id="localidade" placeholder="Ex: SP, RJ, AM">
            
            <label for="complexidade">Complexidade do Projeto:</label>
            <select id="complexidade">
                <option value="Baixa">Baixa</option>
                <option value="Média" selected>Média</option>
                <option value="Alta">Alta</option>
            </select>
            <p>
                <strong>Baixa:</strong> Projetos simples, com poucos requisitos especiais.<br>
                <strong>Média:</strong> Projetos com complexidade padrão de mercado.<br>
                <strong>Alta:</strong> Projetos com muitos requisitos especiais, alta densidade de informação ou condições desafiadoras.
            </p>
            
            <label for="lod">Nível de Desenvolvimento BIM (LOD):</label>
            <select id="lod">
                <option value="LOD 100">LOD 100</option>
                <option value="LOD 200">LOD 200</option>
                <option value="LOD 300" selected>LOD 300</option>
                <option value="LOD 350">LOD 350</option>
                <option value="LOD 400">LOD 400</option>
                <option value="LOD 500">LOD 500</option>
            </select>
        </section>
        
        <section id="perfis-profissionais-section">
            <h2><span class="titulo-com-fundo">4. Defina o Perfil  dos Profissionais </span></h2>
            <p>Obs: Os Valores Fixados São Média no Brasil. Indique quantos profissionais atuará no projeto ou serviço .</p>
            <div class="perfil-profissional">
                <div class="perfil-info">
                    <label for="eng-junior">Engenheiro Júnior (R$ 85/h)</label>
                    <div class="perfil-descricao">Até 3 anos de experiência — apoio técnico e detalhamento.</div>
                </div>
                <div class="perfil-valor">R$ 85/h</div>
                <input type="number" id="eng-junior" class="perfil-quantidade" min="0" value="0">
            </div>
            
            <div class="perfil-profissional">
                <div class="perfil-info">
                    <label for="eng-pleno">Engenheiro Pleno (R$ 145/h)</label>
                    <div class="perfil-descricao">Entre 3 e 8 anos — atua com autonomia e coordenação parcial.</div>
                </div>
                <div class="perfil-valor">R$ 145/h</div>
                <input type="number" id="eng-pleno" class="perfil-quantidade" min="0" value="1">
            </div>
            
            <div class="perfil-profissional">
                <div class="perfil-info">
                    <label for="eng-senior">Engenheiro Sênior (R$ 210/h)</label>
                    <div class="perfil-descricao">Mais de 8 anos — lidera equipes e assume responsabilidades técnicas complexas.</div>
                </div>
                <div class="perfil-valor">R$ 210/h</div>
                <input type="number" id="eng-senior" class="perfil-quantidade" min="0" value="0">
            </div>
            
            <div class="perfil-profissional">
                <div class="perfil-info">
                    <label for="arq-junior">Arquiteto Júnior (R$ 75/h)</label>
                    <div class="perfil-descricao">Até 3 anos de experiência — apoio técnico e detalhamento.</div>
                </div>
                <div class="perfil-valor">R$ 75/h</div>
                <input type="number" id="arq-junior" class="perfil-quantidade" min="0" value="1">
            </div>
            
            <div class="perfil-profissional">
                <div class="perfil-info">
                    <label for="arq-pleno">Arquiteto Pleno (R$ 125/h)</label>
                    <div class="perfil-descricao">Entre 3 e 8 anos — atua com autonomia e coordenação parcial.</div>
                </div>
                <div class="perfil-valor">R$ 125/h</div>
                <input type="number" id="arq-pleno" class="perfil-quantidade" min="0" value="1">
            </div>
            
            <div class="perfil-profissional">
                <div class="perfil-info">
                    <label for="arq-senior">Arquiteto Sênior (R$ 190/h)</label>
                    <div class="perfil-descricao">Mais de 8 anos — lidera equipes e assume responsabilidades técnicas complexas.</div>
                </div>
                <div class="perfil-valor">R$ 190/h</div>
                <input type="number" id="arq-senior" class="perfil-quantidade" min="0" value="0">
            </div>
            
            <div class="classificacao-profissionais">
                <h4>Classificação dos profissionais:</h4>
                <ul>
                    <li><strong>Júnior:</strong> até 3 anos de experiência — apoio técnico e detalhamento.</li>
                    <li><strong>Pleno:</strong> entre 3 e 8 anos — atua com autonomia e coordenação parcial.</li>
                    <li><strong>Sênior:</strong> mais de 8 anos — lidera equipes e assume responsabilidades técnicas complexas.</li>
                </ul>
            </div>
            
            <div class="distribuicao-horas">
                <h4>Distribuição de Horas por Perfil:</h4>
                <div class="distribuicao-padrao">
                    <p>Por padrão, a carga horária total é distribuída entre os perfis na seguinte proporção:</p>
                    <ul>
                        <li>Júnior: 20% das horas totais</li>
                        <li>Pleno: 40% das horas totais</li>
                        <li>Sênior: 40% das horas totais</li>
                    </ul>
                </div>
                 <p> Ou Você pode distribuir de acordo com seus indicativos:</p>
                <button id="personalizar-distribuicao-btn">Personalizar distribuição de horas</button>
                
                <div id="personalizar-distribuicao" class="personalizar-distribuicao">
                    <p>Informe a porcentagem de participação de cada perfil (a soma deve ser 100%):</p>
                    
                    <div class="distribuicao-input">
                        <label for="perc-junior">Percentual Júnior:</label>
                        <input type="number" id="perc-junior" min="0" max="100" value="20">
                        <span>%</span>
                    </div>
                    
                    <div class="distribuicao-input">
                        <label for="perc-pleno">Percentual Pleno:</label>
                        <input type="number" id="perc-pleno" min="0" max="100" value="40">
                        <span>%</span>
                    </div>
                    
                    <div class="distribuicao-input">
                        <label for="perc-senior">Percentual Sênior:</label>
                        <input type="number" id="perc-senior" min="0" max="100" value="40">
                        <span>%</span>
                    </div>
                    
                    <div class="distribuicao-total">
                        Total: <span id="perc-total">100</span>%
                    </div>
                </div>
            </div>
        </section>
        
        <section id="base-calculo-section">
            <h2><span class="titulo-com-fundo">5. Base de Cálculo Referencial </span></h2>
            
            <button class="base-calculo-btn" data-base="Sinduscon-PA (Norte - Maio/2025)">Sinduscon-PA (Norte - Maio/2025)</button>
            <button class="base-calculo-btn" data-base="Sinduscon-JP (Nordeste - Maio/2024)">Sinduscon-JP (Nordeste - Maio/2024)</button>
            <button class="base-calculo-btn" data-base="Sinduscon-SP (Sudeste - Maio/2025)">Sinduscon-SP (Sudeste - Maio/2025)</button>
            <button class="base-calculo-btn" data-base="Sinduscon-PR (Sul - Maio/2025)">Sinduscon-PR (Sul - Maio/2025)</button>
            <button class="base-calculo-btn selected" data-base="Média de Mercado (Base Edital SRPFAM)">Média de Mercado (Base Edital SRPFAM)</button>
            
            <p>Nota: A disponibilidade e aplicabilidade das bases podem variar. Sinduscon (CUB) é primariamente para custos de OBRA, não de PROJETO. "Média de Mercado" aqui é uma estimativa baseada em editais públicos para PROJETOS BIM.</p>
        </section>
        
       <button id="simular-custo" class="simular-btn">Simular Custo</button>

        
        <section id="resultado" style="display: none;">
            <h2>6. Resultado da Simulação</h2>
            
            <div class="resultado-box faixa-estimada">
                <h3>Faixa Estimada: <span id="faixa-estimada">R$ 0,00 - R$ 0,00</span></h3>
            </div>
            
            <div class="resultado-box valor-sugerido">
                <h3>Valor Sugerido: <span id="valor-sugerido">R$ 0,00</span></h3>
            </div>
            
            <div class="explicacao-detalhada" id="explicacao-detalhada">
                <!-- Conteúdo dinâmico será inserido aqui -->
            </div>
            
            <button id="exportar-pdf">Exportar como PDF</button>
        </section>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Elementos do formulário
            const tipoProjeto = document.getElementById("tipo-projeto");
            const tipoCalculo = document.querySelectorAll('input[name="tipo-calculo"]');
            const areaInput = document.getElementById("area");
            const complexidadeSelect = document.getElementById("complexidade");
            const localidadeInput = document.getElementById("localidade");
            const lodSelect = document.getElementById("lod");
            const baseCalculoBtns = document.querySelectorAll(".base-calculo-btn");
            const simularCustoButton = document.getElementById("simular-custo");
            const exportarPDFButton = document.getElementById("exportar-pdf");
            const baseCalculoSection = document.getElementById("base-calculo-section");
            
            // Elementos de perfis profissionais
            const engJuniorInput = document.getElementById("eng-junior");
            const engPlenoInput = document.getElementById("eng-pleno");
            const engSeniorInput = document.getElementById("eng-senior");
            const arqJuniorInput = document.getElementById("arq-junior");
            const arqPlenoInput = document.getElementById("arq-pleno");
            const arqSeniorInput = document.getElementById("arq-senior");
            
            // Elementos de distribuição de horas
            const personalizarDistribuicaoBtn = document.getElementById("personalizar-distribuicao-btn");
            const personalizarDistribuicaoDiv = document.getElementById("personalizar-distribuicao");
            const percJuniorInput = document.getElementById("perc-junior");
            const percPlenoInput = document.getElementById("perc-pleno");
            const percSeniorInput = document.getElementById("perc-senior");
            const percTotalSpan = document.getElementById("perc-total");
            
            // Elementos de resultado
            const resultadoSection = document.getElementById("resultado");
            const faixaEstimadaElement = document.getElementById("faixa-estimada");
            const valorSugeridoElement = document.getElementById("valor-sugerido");
            const explicacaoDetalhada = document.getElementById("explicacao-detalhada");
            
            // Valores de referência para perfis profissionais
            const valoresPerfis = {
                "eng-junior": 85,
                "eng-pleno": 145,
                "eng-senior": 210,
                "arq-junior": 75,
                "arq-pleno": 125,
                "arq-senior": 190
            };
            
            // Valores de referência por tipo de projeto
            const valoresHora = {
                "Arquitetônico": 145.42,
                "Estrutural": 132.50,
                "Instalação Elétrica": 128.75,
                "Instalação Hidráulica": 118.75,
                "Combate a Incêndio": 108.75,
                "Compatibilização BIM": 155.30,
                "Coordenação BIM": 165.80,
                "As Built / Levantamento BIM": 140.25,
                "Digital Twin": 180.00,
                "Outros (especificar)": 150.00
            };
            
            // Multiplicadores de complexidade
            const multiplicadoresComplexidade = {
                "Baixa": 0.8,
                "Média": 1.0,
                "Alta": 1.3
            };
            
            // Multiplicadores de LOD
            const multiplicadoresLOD = {
                "LOD 100": 0.7,
                "LOD 200": 0.85,
                "LOD 300": 1.0,
                "LOD 350": 1.15,
                "LOD 400": 1.3,
                "LOD 500": 1.5
            };
            
            // Percentuais CAIXA/SINAPI atualizados para cálculo por CUB
            const percentuaisCUB = {
                "Arquitetônico": { min: 0.015, max: 0.020 },
                "Estrutural": { min: 0.008, max: 0.012 },
                 "Instalação Elétrica": { min: 0.005, max: 0.008 },
                 "Instalação Hidráulica": { min: 0.004, max: 0.007 },
                "Combate a Incêndio": { min: 0.003, max: 0.005 },
                "Compatibilização BIM": { min: 0.005, max: 0.010 },
                "Coordenação BIM": { min: 0.005, max: 0.010 },
                "As Built / Levantamento BIM": { min: 0.003, max: 0.006 },
                "Digital Twin": { min: 0.010, max: 0.015 },
                "Outros (especificar)": { min: 0.005, max: 0.010 }
            };
            
            // Valores CUB por região (R$/m²) - Atualizados para Maio 2025
            // Chaves exatamente iguais aos valores de data-base dos botões
            const valoresCUB = {
                "Sinduscon-PA (Norte - Maio/2025)":  2164.98,
                "Sinduscon-JP (Nordeste - Maio/2024)":  1628.59,
                "Sinduscon-SP (Sudeste - Maio/2025)": 2067.04,
                "Sinduscon-PR (Sul - Maio/2025)":  2441.87,
                "Média de Mercado (Base Edital SRPFAM)": 0 // Não usa CUB, usa valor/hora
            };
            
            // Variáveis de estado
            let selecionadaBaseCalculo = "Média de Mercado (Base Edital SRPFAM)";
            let tipoCalculoSelecionado = "metro";
            let distribuicaoPersonalizada = false;
            
            // Selecionar automaticamente a base de cálculo padrão ao carregar a página
            document.querySelector('button[data-base="Média de Mercado (Base Edital SRPFAM)"]').classList.add("selected");
            
            // Função para atualizar a visibilidade das bases de cálculo com base no tipo de cálculo
            function atualizarVisibilidadeBaseCalculo() {
                const baseCalculoBtns = document.querySelectorAll(".base-calculo-btn");
                
                if (tipoCalculoSelecionado === "metro") {
                    // Se o tipo de cálculo for por metro quadrado, mostrar apenas os Sinduscons
                    let sindusconSelecionado = false;
                    
                    baseCalculoBtns.forEach(btn => {
                        const baseCalculo = btn.getAttribute("data-base");
                        if (baseCalculo.includes("Sinduscon")) {
                            btn.style.display = "inline-block";
                            
                            // Se já temos um Sinduscon selecionado, não fazemos nada
                            if (btn.classList.contains("selected")) {
                                sindusconSelecionado = true;
                                selecionadaBaseCalculo = baseCalculo;
                            }
                        } else {
                            btn.style.display = "none";
                            // Se a base selecionada for a que estamos escondendo, remover a seleção
                            if (btn.classList.contains("selected")) {
                                btn.classList.remove("selected");
                            }
                        }
                    });
                    
                    // Se nenhum Sinduscon estiver selecionado, selecionar o primeiro
                    if (!sindusconSelecionado) {
                        const primeiroBotaoSinduscon = document.querySelector('button[data-base*="Sinduscon"]');
                        if (primeiroBotaoSinduscon) {
                            baseCalculoBtns.forEach(b => b.classList.remove("selected"));
                            primeiroBotaoSinduscon.classList.add("selected");
                            selecionadaBaseCalculo = primeiroBotaoSinduscon.getAttribute("data-base");
                        }
                    }
                    
                    // Adicionar mensagem explicativa
                    const mensagemExplicativa = document.getElementById("mensagem-sinduscon");
                    if (!mensagemExplicativa) {
                        const mensagem = document.createElement("p");
                        mensagem.id = "mensagem-sinduscon";
                        mensagem.innerHTML = "<strong>Nota:</strong> Para cálculo por metro quadrado (R$/m²), é necessário selecionar uma base Sinduscon.";
                        mensagem.style.color = "#0077b6";
                        mensagem.style.marginTop = "10px";
                        baseCalculoSection.appendChild(mensagem);
                    }
                } else {
                    // Para outros tipos de cálculo, mostrar todas as bases
                    baseCalculoBtns.forEach(btn => {
                        btn.style.display = "inline-block";
                    });
                    
                    // Remover mensagem explicativa se existir
                    const mensagemExplicativa = document.getElementById("mensagem-sinduscon");
                    if (mensagemExplicativa) {
                        baseCalculoSection.removeChild(mensagemExplicativa);
                    }
                }
            }
            
            // Adiciona evento de clique aos botões de base de cálculo
            baseCalculoBtns.forEach(btn => {
                btn.addEventListener("click", function() {
                    // Remove a classe 'selected' de todos os botões
                    baseCalculoBtns.forEach(b => b.classList.remove("selected"));
                    
                    // Adiciona a classe 'selected' ao botão clicado
                    this.classList.add("selected");
                    
                    // Atualiza a base de cálculo selecionada
                    selecionadaBaseCalculo = this.getAttribute("data-base");
                    console.log("Base selecionada:", selecionadaBaseCalculo);
                });
            });
            
            // Adiciona eventos aos inputs de tipo de cálculo
            tipoCalculo.forEach(radio => {
                radio.addEventListener("change", function() {
                    tipoCalculoSelecionado = this.value;
                    atualizarVisibilidadeBaseCalculo();
                });
            });
            
            // Inicializar a visibilidade das bases de cálculo
            atualizarVisibilidadeBaseCalculo();
            
            // Adiciona evento ao botão de personalizar distribuição
            personalizarDistribuicaoBtn.addEventListener("click", function() {
                distribuicaoPersonalizada = !distribuicaoPersonalizada;
                if (distribuicaoPersonalizada) {
                    personalizarDistribuicaoDiv.classList.add("ativo");
                    this.textContent = "Usar distribuição padrão";
                } else {
                    personalizarDistribuicaoDiv.classList.remove("ativo");
                    this.textContent = "Personalizar distribuição de horas";
                    // Restaurar valores padrão
                    percJuniorInput.value = 20;
                    percPlenoInput.value = 40;
                    percSeniorInput.value = 40;
                    atualizarTotalPercentual();
                }
            });
            
            // Adiciona eventos aos inputs de percentual
            [percJuniorInput, percPlenoInput, percSeniorInput].forEach(input => {
                input.addEventListener("input", atualizarTotalPercentual);
            });
            
            // Função para atualizar o total de percentual
            function atualizarTotalPercentual() {
                const percJunior = parseInt(percJuniorInput.value || 0);
                const percPleno = parseInt(percPlenoInput.value || 0);
                const percSenior = parseInt(percSeniorInput.value || 0);
                
                const total = percJunior + percPleno + percSenior;
                percTotalSpan.textContent = total;
                
                // Destacar se o total não for 100%
                if (total !== 100) {
                    percTotalSpan.style.color = "red";
                } else {
                    percTotalSpan.style.color = "";
                }
            }
            
            // Função para obter o total de profissionais
            function getTotalProfissionais() {
                return parseInt(engJuniorInput.value || 0) +
                       parseInt(engPlenoInput.value || 0) +
                       parseInt(engSeniorInput.value || 0) +
                       parseInt(arqJuniorInput.value || 0) +
                       parseInt(arqPlenoInput.value || 0) +
                       parseInt(arqSeniorInput.value || 0);
            }
            
            // Função para calcular o valor médio por hora dos profissionais
            function getValorMedioPorHora() {
                const totalProfissionais = getTotalProfissionais();
                if (totalProfissionais === 0) return 0;
                
                const valorTotal = 
                    (parseInt(engJuniorInput.value || 0) * valoresPerfis["eng-junior"]) +
                    (parseInt(engPlenoInput.value || 0) * valoresPerfis["eng-pleno"]) +
                    (parseInt(engSeniorInput.value || 0) * valoresPerfis["eng-senior"]) +
                    (parseInt(arqJuniorInput.value || 0) * valoresPerfis["arq-junior"]) +
                    (parseInt(arqPlenoInput.value || 0) * valoresPerfis["arq-pleno"]) +
                    (parseInt(arqSeniorInput.value || 0) * valoresPerfis["arq-senior"]);
                
                return valorTotal / totalProfissionais;
            }
            
            // Função para calcular o valor do projeto
            function calcularValorProjeto() {
                // Obtém os valores dos inputs
                const tipoProjetoSelecionado = tipoProjeto.value;
                const area = parseFloat(areaInput.value) || 0;
                const complexidadeSelecionada = complexidadeSelect.value;
                const lodSelecionado = lodSelect.value;
                
                // Obtém os multiplicadores
                const multiplicadorComplexidade = multiplicadoresComplexidade[complexidadeSelecionada];
                const multiplicadorLOD = multiplicadoresLOD[lodSelecionado];
                
                let valorTotal = 0;
                let valorHora = valoresHora[tipoProjetoSelecionado];
                let horasEstimadas = 0;
                let explicacao = "";
                
                // Verificar se é cálculo por metro quadrado
                if (tipoCalculoSelecionado === "metro") {
                    // Verificar se uma base Sinduscon foi selecionada
                    if (!selecionadaBaseCalculo.includes("Sinduscon")) {
                        alert("Escolha uma base Sinduscon válida para continuar.");
                        return null;
                    }
                    
                    // Obter o valor CUB da base selecionada
                    const valorCUB = valoresCUB[selecionadaBaseCalculo];
                    console.log("Valor CUB para", selecionadaBaseCalculo, ":", valorCUB);
                    
                    // Verificar se o valor CUB é válido
                    if (!valorCUB || valorCUB <= 0) {
                        alert("Escolha uma base Sinduscon válida para continuar.");
                        return null;
                    }
                    
                    // Obter os percentuais para o tipo de projeto
                    const percentualMin = percentuaisCUB[tipoProjetoSelecionado].min;
                    const percentualMax = percentuaisCUB[tipoProjetoSelecionado].max;
                    
                    // Calcular o valor do projeto (desconsiderando profissionais e horas)
                    const valorTotalMin = area * valorCUB * percentualMin * multiplicadorComplexidade * multiplicadorLOD;
                    const valorTotalMax = area * valorCUB * percentualMax * multiplicadorComplexidade * multiplicadorLOD;
                    valorTotal = (valorTotalMin + valorTotalMax) / 2;
                    
                    // Explicação detalhada
                    explicacao = `
                        <h3>Fórmula utilizada:</h3>
                        <div class="formula">Valor Total = Área × Valor CUB × Percentual Projeto × Multiplicador Complexidade × Multiplicador LOD</div>
                        
                        <h3>Passos do cálculo:</h3>
                        <ol>
                            <li>Valor CUB base (${selecionadaBaseCalculo}): R$ ${valorCUB.toFixed(2)}/m²</li>
                            <li>Percentual para projeto ${tipoProjetoSelecionado}: ${(percentualMin * 100).toFixed(1)}% a ${(percentualMax * 100).toFixed(1)}% do CUB</li>
                            <li>Aplicação dos multiplicadores de complexidade (${complexidadeSelecionada}: ${multiplicadorComplexidade.toFixed(2)}) e LOD (${lodSelecionado}: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Valor mínimo: ${area}m² × R$ ${valorCUB.toFixed(2)}/m² × ${(percentualMin * 100).toFixed(1)}% × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorTotalMin.toFixed(2)}</li>
                            <li>Valor máximo: ${area}m² × R$ ${valorCUB.toFixed(2)}/m² × ${(percentualMax * 100).toFixed(1)}% × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorTotalMax.toFixed(2)}</li>
                            <li>Valor sugerido (média): R$ ${valorTotal.toFixed(2)}</li>
                        </ol>
                        
                        <h3>Observações sobre o Cálculo:</h3>
                        <ul>
                            <li>Base de Referência: ${selecionadaBaseCalculo}</li>
                            <li>Valor do CUB: R$ ${valorCUB.toFixed(2)}/m²</li>
                            <li>Percentuais baseados nas referências CAIXA/SINAPI para projetos BIM</li>
                            <li>Tipo de Projeto Principal: ${tipoProjetoSelecionado}</li>
                            <li>Complexidade: ${complexidadeSelecionada} (multiplicador: ${multiplicadorComplexidade.toFixed(2)})</li>
                            <li>LOD: ${lodSelecionado} (multiplicador: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Área do Projeto: ${area} m²</li>
                            <li>Nota: Para cálculo por metro quadrado (R$/m²), os profissionais envolvidos e suas horas não são considerados diretamente no cálculo.</li>
                        </ul>
                    `;
                } else if (tipoCalculoSelecionado === "hora-perfil") {
                    // Cálculo por hora técnica dos profissionais envolvidos
                    const totalProfissionais = getTotalProfissionais();
                    if (totalProfissionais === 0) {
                        alert("Por favor, informe a quantidade de pelo menos um perfil profissional.");
                        return null;
                    }
                    
                    // Verificar se a distribuição personalizada está ativa e se a soma é 100%
                    if (distribuicaoPersonalizada) {
                        const percJunior = parseInt(percJuniorInput.value || 0);
                        const percPleno = parseInt(percPlenoInput.value || 0);
                        const percSenior = parseInt(percSeniorInput.value || 0);
                        
                        if (percJunior + percPleno + percSenior !== 100) {
                            alert("A soma dos percentuais de distribuição deve ser 100%. Por favor, ajuste os valores.");
                            return null;
                        }
                    }
                    
                    // Calcular horas estimadas por tipo de projeto e área
                    horasEstimadas = Math.max(300, (area / 10) * 1.0); // Base de horas por projeto
                    
                    // Contagem de profissionais por nível
                    const qtdJunior = parseInt(engJuniorInput.value || 0) + parseInt(arqJuniorInput.value || 0);
                    const qtdPleno = parseInt(engPlenoInput.value || 0) + parseInt(arqPlenoInput.value || 0);
                    const qtdSenior = parseInt(engSeniorInput.value || 0) + parseInt(arqSeniorInput.value || 0);
                    
                    // Distribuição de horas por nível (padrão ou personalizada)
                    let percJunior, percPleno, percSenior;
                    
                    if (distribuicaoPersonalizada) {
                        percJunior = parseInt(percJuniorInput.value || 0) / 100;
                        percPleno = parseInt(percPlenoInput.value || 0) / 100;
                        percSenior = parseInt(percSeniorInput.value || 0) / 100;
                    } else {
                        // Distribuição padrão: Júnior 20%, Pleno 40%, Sênior 40%
                        percJunior = 0.2;
                        percPleno = 0.4;
                        percSenior = 0.4;
                    }
                    
                    // Calcular horas por nível
                    const horasJunior = qtdJunior > 0 ? horasEstimadas * percJunior : 0;
                    const horasPleno = qtdPleno > 0 ? horasEstimadas * percPleno : 0;
                    const horasSenior = qtdSenior > 0 ? horasEstimadas * percSenior : 0;
                    
                    // Distribuir horas entre os profissionais de cada nível
                    let horasEngJunior = 0, horasArqJunior = 0;
                    let horasEngPleno = 0, horasArqPleno = 0;
                    let horasEngSenior = 0, horasArqSenior = 0;
                    
                    // Distribuição para Júnior
                    if (qtdJunior > 0) {
                        const engJuniorQtd = parseInt(engJuniorInput.value || 0);
                        const arqJuniorQtd = parseInt(arqJuniorInput.value || 0);
                        
                        if (engJuniorQtd > 0) {
                            horasEngJunior = horasJunior * (engJuniorQtd / qtdJunior);
                        }
                        
                        if (arqJuniorQtd > 0) {
                            horasArqJunior = horasJunior * (arqJuniorQtd / qtdJunior);
                        }
                    }
                    
                    // Distribuição para Pleno
                    if (qtdPleno > 0) {
                        const engPlenoQtd = parseInt(engPlenoInput.value || 0);
                        const arqPlenoQtd = parseInt(arqPlenoInput.value || 0);
                        
                        if (engPlenoQtd > 0) {
                            horasEngPleno = horasPleno * (engPlenoQtd / qtdPleno);
                        }
                        
                        if (arqPlenoQtd > 0) {
                            horasArqPleno = horasPleno * (arqPlenoQtd / qtdPleno);
                        }
                    }
                    
                    // Distribuição para Sênior
                    if (qtdSenior > 0) {
                        const engSeniorQtd = parseInt(engSeniorInput.value || 0);
                        const arqSeniorQtd = parseInt(arqSeniorInput.value || 0);
                        
                        if (engSeniorQtd > 0) {
                            horasEngSenior = horasSenior * (engSeniorQtd / qtdSenior);
                        }
                        
                        if (arqSeniorQtd > 0) {
                            horasArqSenior = horasSenior * (arqSeniorQtd / qtdSenior);
                        }
                    }
                    
                    // Cálculo do valor total por perfil
                    const valorEngJunior = parseInt(engJuniorInput.value || 0) > 0 ? 
                        valoresPerfis["eng-junior"] * horasEngJunior * multiplicadorComplexidade * multiplicadorLOD : 0;
                        
                    const valorEngPleno = parseInt(engPlenoInput.value || 0) > 0 ? 
                        valoresPerfis["eng-pleno"] * horasEngPleno * multiplicadorComplexidade * multiplicadorLOD : 0;
                        
                    const valorEngSenior = parseInt(engSeniorInput.value || 0) > 0 ? 
                        valoresPerfis["eng-senior"] * horasEngSenior * multiplicadorComplexidade * multiplicadorLOD : 0;
                        
                    const valorArqJunior = parseInt(arqJuniorInput.value || 0) > 0 ? 
                        valoresPerfis["arq-junior"] * horasArqJunior * multiplicadorComplexidade * multiplicadorLOD : 0;
                        
                    const valorArqPleno = parseInt(arqPlenoInput.value || 0) > 0 ? 
                        valoresPerfis["arq-pleno"] * horasArqPleno * multiplicadorComplexidade * multiplicadorLOD : 0;
                        
                    const valorArqSenior = parseInt(arqSeniorInput.value || 0) > 0 ? 
                        valoresPerfis["arq-senior"] * horasArqSenior * multiplicadorComplexidade * multiplicadorLOD : 0;
                    
                    // Valor total do projeto
                    valorTotal = valorEngJunior + valorEngPleno + valorEngSenior + valorArqJunior + valorArqPleno + valorArqSenior;
                    
                    // Explicação detalhada
                    explicacao = `
                        <h3>Fórmula utilizada:</h3>
                        <div class="formula">Valor Total = Σ(Valor/Hora do Perfil × Horas Alocadas × Multiplicador Complexidade × Multiplicador LOD)</div>
                        
                        <h3>Passos do cálculo:</h3>
                        <ol>
                            <li>Estimativa de horas totais do projeto: (${area}m² ÷ 10) = ${horasEstimadas.toFixed(0)}h</li>
                            <li>Aplicação dos multiplicadores de complexidade (${complexidadeSelecionada}: ${multiplicadorComplexidade.toFixed(2)}) e LOD (${lodSelecionado}: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Distribuição das horas por nível profissional:
                                <ul>
                                    <li>Júnior: ${(percJunior * 100).toFixed(0)}% = ${(horasJunior).toFixed(0)}h</li>
                                    <li>Pleno: ${(percPleno * 100).toFixed(0)}% = ${(horasPleno).toFixed(0)}h</li>
                                    <li>Sênior: ${(percSenior * 100).toFixed(0)}% = ${(horasSenior).toFixed(0)}h</li>
                                </ul>
                            </li>
                            <li>Cálculo por perfil profissional:
                                <ul>
                                    ${parseInt(engJuniorInput.value || 0) > 0 ? `<li>Engenheiro Júnior: R$ ${valoresPerfis["eng-junior"].toFixed(2)}/h × ${horasEngJunior.toFixed(0)}h × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorEngJunior.toFixed(2)}</li>` : ''}
                                    ${parseInt(engPlenoInput.value || 0) > 0 ? `<li>Engenheiro Pleno: R$ ${valoresPerfis["eng-pleno"].toFixed(2)}/h × ${horasEngPleno.toFixed(0)}h × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorEngPleno.toFixed(2)}</li>` : ''}
                                    ${parseInt(engSeniorInput.value || 0) > 0 ? `<li>Engenheiro Sênior: R$ ${valoresPerfis["eng-senior"].toFixed(2)}/h × ${horasEngSenior.toFixed(0)}h × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorEngSenior.toFixed(2)}</li>` : ''}
                                    ${parseInt(arqJuniorInput.value || 0) > 0 ? `<li>Arquiteto Júnior: R$ ${valoresPerfis["arq-junior"].toFixed(2)}/h × ${horasArqJunior.toFixed(0)}h × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorArqJunior.toFixed(2)}</li>` : ''}
                                    ${parseInt(arqPlenoInput.value || 0) > 0 ? `<li>Arquiteto Pleno: R$ ${valoresPerfis["arq-pleno"].toFixed(2)}/h × ${horasArqPleno.toFixed(0)}h × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorArqPleno.toFixed(2)}</li>` : ''}
                                    ${parseInt(arqSeniorInput.value || 0) > 0 ? `<li>Arquiteto Sênior: R$ ${valoresPerfis["arq-senior"].toFixed(2)}/h × ${horasArqSenior.toFixed(0)}h × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorArqSenior.toFixed(2)}</li>` : ''}
                                </ul>
                            </li>
                            <li>Valor total do projeto: R$ ${valorTotal.toFixed(2)}</li>
                            <li>Faixa estimada: R$ ${valorTotal.toFixed(2)} ± 25% = R$ ${(valorTotal * 0.75).toFixed(2)} a R$ ${(valorTotal * 1.25).toFixed(2)}</li>
                        </ol>
                        
                        <h3>Observações sobre o Cálculo:</h3>
                        <ul>
                            <li>Tipo de Projeto Principal: ${tipoProjetoSelecionado}</li>
                            <li>Complexidade: ${complexidadeSelecionada} (multiplicador: ${multiplicadorComplexidade.toFixed(2)})</li>
                            <li>LOD: ${lodSelecionado} (multiplicador: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Área do Projeto: ${area} m²</li>
                            <li>Distribuição de horas: ${distribuicaoPersonalizada ? 'Personalizada' : 'Padrão'} (Júnior: ${(percJunior * 100).toFixed(0)}%, Pleno: ${(percPleno * 100).toFixed(0)}%, Sênior: ${(percSenior * 100).toFixed(0)}%)</li>
                            <li>Perfis Profissionais Envolvidos:
                                <ul>
                                    ${parseInt(engJuniorInput.value || 0) > 0 ? `<li>Engenheiro Júnior: ${engJuniorInput.value} (R$ ${valoresPerfis["eng-junior"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(engPlenoInput.value || 0) > 0 ? `<li>Engenheiro Pleno: ${engPlenoInput.value} (R$ ${valoresPerfis["eng-pleno"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(engSeniorInput.value || 0) > 0 ? `<li>Engenheiro Sênior: ${engSeniorInput.value} (R$ ${valoresPerfis["eng-senior"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(arqJuniorInput.value || 0) > 0 ? `<li>Arquiteto Júnior: ${arqJuniorInput.value} (R$ ${valoresPerfis["arq-junior"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(arqPlenoInput.value || 0) > 0 ? `<li>Arquiteto Pleno: ${arqPlenoInput.value} (R$ ${valoresPerfis["arq-pleno"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(arqSeniorInput.value || 0) > 0 ? `<li>Arquiteto Sênior: ${arqSeniorInput.value} (R$ ${valoresPerfis["arq-senior"].toFixed(2)}/h)</li>` : ''}
                                </ul>
                            </li>
                            <li>Total de Profissionais: ${totalProfissionais}</li>
                            <li>Valor Médio por Hora: R$ ${getValorMedioPorHora().toFixed(2)}/h</li>
                        </ul>
                    `;
                } else if (selecionadaBaseCalculo === "Média de Mercado (Base Edital SRPFAM)") {
                    // Cálculo por hora técnica (padrão SRPFAM)
                    const totalProfissionais = getTotalProfissionais();
                    horasEstimadas = Math.max(300, (area / 10) * totalProfissionais * 1.0); // Fator de ajuste 1.0
                    valorTotal = valorHora * multiplicadorComplexidade * multiplicadorLOD * horasEstimadas;
                    
                    // Explicação detalhada
                    explicacao = `
                        <h3>Fórmula utilizada:</h3>
                        <div class="formula">Valor Total = Valor/Hora × Multiplicador Complexidade × Multiplicador LOD × Horas Estimadas</div>
                        
                        <h3>Passos do cálculo:</h3>
                        <ol>
                            <li>Valor/hora base (Edital SRPFAM (${tipoProjetoSelecionado})): R$ ${valorHora.toFixed(2)}/h</li>
                            <li>Aplicação dos multiplicadores de complexidade (${complexidadeSelecionada}: ${multiplicadorComplexidade.toFixed(2)}) e LOD (${lodSelecionado}: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Valor/hora ajustado: R$ ${valorHora.toFixed(2)} × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${(valorHora * multiplicadorComplexidade * multiplicadorLOD).toFixed(2)}/h</li>
                            <li>Estimativa de horas: (${area}m² ÷ 10) × ${totalProfissionais} profissionais × fatores de ajuste = ${horasEstimadas}h</li>
                            <li>Sem ajuste de horas mínimas necessário: ${horasEstimadas}h</li>
                            <li>Valor total do projeto: R$ ${(valorHora * multiplicadorComplexidade * multiplicadorLOD).toFixed(2)}/h × ${horasEstimadas}h = R$ ${valorTotal.toFixed(2)}</li>
                            <li>Faixa estimada: R$ ${valorTotal.toFixed(2)} ± 25% = R$ ${(valorTotal * 0.75).toFixed(2)} a R$ ${(valorTotal * 1.25).toFixed(2)}</li>
                        </ol>
                        
                        <h3>Observações sobre o Cálculo:</h3>
                        <ul>
                            <li>Base de Referência: Edital SRPFAM (Anexo Planilhas) - Ref. Média de Mercado (Nacional)</li>
                            <li>Valores de Hora Técnica (HT) e Total de Projeto extraídos do Anexo XVII do Edital SRPFAM.</li>
                            <li>Tipo de Projeto Principal: ${tipoProjetoSelecionado}</li>
                            <li>Complexidade: ${complexidadeSelecionada} (multiplicador: ${multiplicadorComplexidade.toFixed(2)})</li>
                            <li>LOD: ${lodSelecionado} (multiplicador: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Área do Projeto: ${area} m²</li>
                            <li>Perfis Profissionais Envolvidos:
                                <ul>
                                    ${parseInt(engJuniorInput.value || 0) > 0 ? `<li>Engenheiro Júnior: ${engJuniorInput.value} (R$ ${valoresPerfis["eng-junior"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(engPlenoInput.value || 0) > 0 ? `<li>Engenheiro Pleno: ${engPlenoInput.value} (R$ ${valoresPerfis["eng-pleno"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(engSeniorInput.value || 0) > 0 ? `<li>Engenheiro Sênior: ${engSeniorInput.value} (R$ ${valoresPerfis["eng-senior"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(arqJuniorInput.value || 0) > 0 ? `<li>Arquiteto Júnior: ${arqJuniorInput.value} (R$ ${valoresPerfis["arq-junior"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(arqPlenoInput.value || 0) > 0 ? `<li>Arquiteto Pleno: ${arqPlenoInput.value} (R$ ${valoresPerfis["arq-pleno"].toFixed(2)}/h)</li>` : ''}
                                    ${parseInt(arqSeniorInput.value || 0) > 0 ? `<li>Arquiteto Sênior: ${arqSeniorInput.value} (R$ ${valoresPerfis["arq-senior"].toFixed(2)}/h)</li>` : ''}
                                </ul>
                            </li>
                            <li>Total de Profissionais: ${totalProfissionais}</li>
                            <li>Impacto da Qtd. de Profissionais: No cálculo por Hora Técnica, a quantidade de profissionais afeta diretamente a estimativa de horas totais do projeto.</li>
                        </ul>
                    `;
                } else {
                    // Cálculo baseado no CUB (Sinduscon)
                    const valorCUB = valoresCUB[selecionadaBaseCalculo];
                    console.log("Valor CUB para", selecionadaBaseCalculo, ":", valorCUB);
                    
                    // Verificar se o valor CUB é válido
                    if (!valorCUB || valorCUB <= 0) {
                        alert("Escolha uma base Sinduscon válida para continuar.");
                        return null;
                    }
                    
                    const percentualMin = percentuaisCUB[tipoProjetoSelecionado].min;
                    const percentualMax = percentuaisCUB[tipoProjetoSelecionado].max;
                    
                    // Valor total baseado na área e percentual do CUB
                    const valorTotalMin = area * valorCUB * percentualMin * multiplicadorComplexidade * multiplicadorLOD;
                    const valorTotalMax = area * valorCUB * percentualMax * multiplicadorComplexidade * multiplicadorLOD;
                    valorTotal = (valorTotalMin + valorTotalMax) / 2;
                    
                    // Explicação detalhada
                    explicacao = `
                        <h3>Fórmula utilizada:</h3>
                        <div class="formula">Valor Total = Área × Valor CUB × Percentual Projeto × Multiplicador Complexidade × Multiplicador LOD</div>
                        
                        <h3>Passos do cálculo:</h3>
                        <ol>
                            <li>Valor CUB base (${selecionadaBaseCalculo}): R$ ${valorCUB.toFixed(2)}/m²</li>
                            <li>Percentual para projeto ${tipoProjetoSelecionado}: ${(percentualMin * 100).toFixed(1)}% a ${(percentualMax * 100).toFixed(1)}% do CUB</li>
                            <li>Aplicação dos multiplicadores de complexidade (${complexidadeSelecionada}: ${multiplicadorComplexidade.toFixed(2)}) e LOD (${lodSelecionado}: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Valor mínimo: ${area}m² × R$ ${valorCUB.toFixed(2)}/m² × ${(percentualMin * 100).toFixed(1)}% × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorTotalMin.toFixed(2)}</li>
                            <li>Valor máximo: ${area}m² × R$ ${valorCUB.toFixed(2)}/m² × ${(percentualMax * 100).toFixed(1)}% × ${multiplicadorComplexidade.toFixed(2)} × ${multiplicadorLOD.toFixed(2)} = R$ ${valorTotalMax.toFixed(2)}</li>
                            <li>Valor sugerido (média): R$ ${valorTotal.toFixed(2)}</li>
                        </ol>
                        
                        <h3>Observações sobre o Cálculo:</h3>
                        <ul>
                            <li>Base de Referência: ${selecionadaBaseCalculo}</li>
                            <li>Valor do CUB: R$ ${valorCUB.toFixed(2)}/m²</li>
                            <li>Percentuais baseados nas referências CAIXA/SINAPI para projetos BIM</li>
                            <li>Tipo de Projeto Principal: ${tipoProjetoSelecionado}</li>
                            <li>Complexidade: ${complexidadeSelecionada} (multiplicador: ${multiplicadorComplexidade.toFixed(2)})</li>
                            <li>LOD: ${lodSelecionado} (multiplicador: ${multiplicadorLOD.toFixed(2)})</li>
                            <li>Área do Projeto: ${area} m²</li>
                            <li>Nota: Para cálculo por metro quadrado (R$/m²), os profissionais envolvidos e suas horas não são considerados diretamente no cálculo.</li>
                        </ul>
                    `;
                }
                
                // Retorna os resultados
                return {
                    valorTotal: valorTotal,
                    faixaMin: valorTotal * 0.75,
                    faixaMax: valorTotal * 1.25,
                    explicacao: explicacao
                };
            }
            
            // Função para atualizar a interface com os resultados
            function atualizarResultados(resultados) {
                // Exibe a seção de resultados
                resultadoSection.style.display = "block";
                
                // Atualiza os valores
                faixaEstimadaElement.textContent = `R$ ${resultados.faixaMin.toFixed(2)} - R$ ${resultados.faixaMax.toFixed(2)}`;
                valorSugeridoElement.textContent = `R$ ${resultados.valorTotal.toFixed(2)}`;
                
                // Atualiza a explicação detalhada
                explicacaoDetalhada.innerHTML = resultados.explicacao;
                
                // Rola a página para mostrar os resultados
                resultadoSection.scrollIntoView({ behavior: 'smooth' });
            }
            
            // Adiciona evento de clique ao botão de simulação
            simularCustoButton.addEventListener("click", function() {
                // Verifica se os campos obrigatórios estão preenchidos
                if (!areaInput.value) {
                    alert("Por favor, informe a área do projeto.");
                    return;
                }
                
                // Verifica se pelo menos um profissional foi selecionado (exceto para cálculo por m²)
                if (tipoCalculoSelecionado !== "metro" && getTotalProfissionais() === 0) {
                    alert("Por favor, informe a quantidade de pelo menos um perfil profissional.");
                    return;
                }
                
                // Verifica se o tipo de cálculo é por metro quadrado e se uma base Sinduscon foi selecionada
                if (tipoCalculoSelecionado === "metro" && !selecionadaBaseCalculo.includes("Sinduscon")) {
                    alert("Escolha uma base Sinduscon válida para continuar.");
                    return;
                }
                
                // Calcula os resultados
                const resultados = calcularValorProjeto();
                
                // Se resultados for null, houve algum erro no cálculo
                if (resultados === null) {
                    return;
                }
                
                // Atualiza a interface
                atualizarResultados(resultados);
            });
            
            // Função para exportar para PDF
            function exportarParaPDF() {
                // Verifica se há resultados para exportar
                if (resultadoSection.style.display !== "block") {
                    alert("Por favor, realize uma simulação antes de exportar o relatório.");
                    return;
                }
                
                // Criar elemento para conteúdo do PDF
                const conteudoPDF = document.createElement("div");
                conteudoPDF.className = "pdf-content";
                
                // Adicionar estilos para o PDF
                const estilosPDF = document.createElement("style");
                estilosPDF.textContent = `
                    .pdf-content {
                        font-family: Arial, sans-serif;
                        color: #333;
                        line-height: 1.5;
                    }
                    .pdf-header {
                        text-align: center;
                        margin-bottom: 20px;
                    }
                    .pdf-header h1 {
                        color: #0077b6;
                        font-size: 24px;
                        margin-bottom: 10px;
                    }
                    .pdf-section {
                        margin-bottom: 20px;
                    }
                    .pdf-section h2 {
                        color: #0077b6;
                        font-size: 18px;
                        border-bottom: 1px solid #0077b6;
                        padding-bottom: 5px;
                        margin-bottom: 10px;
                    }
                    .pdf-resultado {
                        padding: 10px;
                        margin: 10px 0;
                        border-left: 4px solid #0077b6;
                        background-color: #f0f8ff;
                    }
                    .pdf-footer {
                        margin-top: 30px;
                        text-align: center;
                        font-size: 12px;
                        color: #666;
                    }
                `;
                conteudoPDF.appendChild(estilosPDF);
                
                // Adicionar cabeçalho
                const header = document.createElement("div");
                header.className = "pdf-header";
                header.innerHTML = `<h1>Simulador de Custos de Projetos BIM - SIPP BIM</h1>`;
                conteudoPDF.appendChild(header);
                
                // Adicionar dados do projeto
                const dadosProjeto = document.createElement("div");
                dadosProjeto.className = "pdf-section";
                dadosProjeto.innerHTML = `
                    <h2>Dados do Projeto</h2>
                    <p><strong>Tipo de Projeto:</strong> ${tipoProjeto.options[tipoProjeto.selectedIndex].text}</p>
                    <p><strong>Área:</strong> ${areaInput.value} m²</p>
                    <p><strong>Complexidade:</strong> ${complexidadeSelect.value}</p>
                    <p><strong>LOD:</strong> ${lodSelect.value}</p>
                    <p><strong>Base de Cálculo:</strong> ${selecionadaBaseCalculo}</p>
                    <p><strong>Tipo de Cálculo:</strong> ${tipoCalculoSelecionado === "metro" ? "Por metro quadrado" : 
                                                        tipoCalculoSelecionado === "hora" ? "Por hora técnica" : 
                                                        tipoCalculoSelecionado === "hora-perfil" ? "Por Hora Técnica dos Profissionais Envolvidos" : 
                                                        "Por escopo"}</p>
                    <p><strong>Localidade:</strong> ${localidadeInput.value || "Não informado"}</p>
                `;
                conteudoPDF.appendChild(dadosProjeto);
                
                // Adicionar perfis profissionais (exceto para cálculo por m²)
                if (tipoCalculoSelecionado !== "metro") {
                    const perfisProfissionais = document.createElement("div");
                    perfisProfissionais.className = "pdf-section";
                    
                    let perfilHTML = `<h2>Perfis Profissionais</h2><ul>`;
                    if (parseInt(engJuniorInput.value || 0) > 0) perfilHTML += `<li>Engenheiro Júnior: ${engJuniorInput.value}</li>`;
                    if (parseInt(engPlenoInput.value || 0) > 0) perfilHTML += `<li>Engenheiro Pleno: ${engPlenoInput.value}</li>`;
                    if (parseInt(engSeniorInput.value || 0) > 0) perfilHTML += `<li>Engenheiro Sênior: ${engSeniorInput.value}</li>`;
                    if (parseInt(arqJuniorInput.value || 0) > 0) perfilHTML += `<li>Arquiteto Júnior: ${arqJuniorInput.value}</li>`;
                    if (parseInt(arqPlenoInput.value || 0) > 0) perfilHTML += `<li>Arquiteto Pleno: ${arqPlenoInput.value}</li>`;
                    if (parseInt(arqSeniorInput.value || 0) > 0) perfilHTML += `<li>Arquiteto Sênior: ${arqSeniorInput.value}</li>`;
                    perfilHTML += `</ul>`;
                    
                    // Adicionar informações de distribuição de horas
                    if (tipoCalculoSelecionado === "hora-perfil") {
                        let distribuicaoHoras = "Padrão (Júnior: 20%, Pleno: 40%, Sênior: 40%)";
                        if (distribuicaoPersonalizada) {
                            distribuicaoHoras = `Personalizada (Júnior: ${percJuniorInput.value}%, Pleno: ${percPlenoInput.value}%, Sênior: ${percSeniorInput.value}%)`;
                        }
                        perfilHTML += `<p><strong>Distribuição de Horas:</strong> ${distribuicaoHoras}</p>`;
                    }
                    
                    perfisProfissionais.innerHTML = perfilHTML;
                    conteudoPDF.appendChild(perfisProfissionais);
                }
                
                // Adicionar resultados
                const resultados = document.createElement("div");
                resultados.className = "pdf-section";
                resultados.innerHTML = `
                    <h2>Resultados da Simulação</h2>
                    <div class="pdf-resultado">
                        <p><strong>Faixa Estimada:</strong> ${faixaEstimadaElement.textContent}</p>
                        <p><strong>Valor Sugerido:</strong> ${valorSugeridoElement.textContent}</p>
                    </div>
                `;
                conteudoPDF.appendChild(resultados);
                
                // Adicionar explicação detalhada
                const explicacao = document.createElement("div");
                explicacao.className = "pdf-section";
                explicacao.innerHTML = `
                    <h2>Explicação Detalhada do Cálculo</h2>
                    ${explicacaoDetalhada.innerHTML}
                `;
                conteudoPDF.appendChild(explicacao);
                
                // Adicionar rodapé
                const footer = document.createElement("div");
                footer.className = "pdf-footer";
                const dataHora = new Date().toLocaleString('pt-BR');
                footer.innerHTML = `
                    <p>Relatório gerado em: ${dataHora}</p>
                    <p>© SIPP BIM - Simulador de Precificação  de Projetos BIM</p>
                     <p>Desenvolvido por : RBIM CONSULTORIA - DIREITOS RESERVADOS</p>
                `;
                conteudoPDF.appendChild(footer);
                
                // Converter para HTML string
                const htmlContent = conteudoPDF.outerHTML;
                
                // Criar um Blob com o conteúdo HTML
                const blob = new Blob([`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>Simulação de Custos BIM</title>
                        <style>
                            body {
                                font-family: Arial, sans-serif;
                                line-height: 1.6;
                                color: #333;
                                max-width: 800px;
                                margin: 0 auto;
                                padding: 20px;
                            }
                            h1 {
                                color: #0077b6;
                                text-align: center;
                            }
                            h2 {
                                color: #0077b6;
                                border-bottom: 1px solid #0077b6;
                                padding-bottom: 5px;
                            }
                            .formula {
                                background-color: #f1f8ff;
                                padding: 10px;
                                border-left: 5px solid #0077b6;
                                margin: 15px 0;
                                font-family: monospace;
                            }
                            .pdf-resultado {
                                padding: 10px;
                                margin: 10px 0;
                                border-left: 4px solid #0077b6;
                                background-color: #f0f8ff;
                            }
                            .pdf-footer {
                                margin-top: 30px;
                                text-align: center;
                                font-size: 12px;
                                color: #666;
                            }
                        </style>
                    </head>
                    <body>
                        ${htmlContent}
                    </body>
                    </html>
                `], { type: 'text/html' });
                
                // Criar URL para o blob
                const blobUrl = URL.createObjectURL(blob);
                
                // Abrir em nova janela para impressão
                const printWindow = window.open(blobUrl, '_blank');
                
                printWindow.onload = function() {
                    printWindow.print();
                    URL.revokeObjectURL(blobUrl);
                };
            }
            
            // Exportar como PDF
            exportarPDFButton.addEventListener("click", exportarParaPDF);
        });
    </script>
</body>
</html>

